{"content":{"out":{"attributes":{"title":"To be or not to be (Random)?!","date":"2021-06-21"},"body":"<p>I have started learning <em><strong>Rust</strong></em> for over a couple of month now, and it has been quite enjoyable. The new concepts that brings in the table is magnificent. Along with that, the thing that first attracted me to <em><strong>Rust</strong></em> was <a href=\"https://github.com/nannou-org/nannou\">Nannou </a>. This blog is about a very simple simulation using nannou. The simulation idea is taken from <a href=\"https://natureofcode.com/\"><code>Nature of Code</code> </a>, which does the same thing but in processing. Let&#39;s get started then.</p>\n<h1 id=\"template-for-nannou\">Template for Nannou</h1>\n<pre><code class=\"hljs language-rust\"><span class=\"hljs-keyword\">use</span> nannou::prelude::*;\n<span class=\"hljs-keyword\">fn</span> <span class=\"hljs-title function_\">main</span>() {\n    nannou::<span class=\"hljs-title function_ invoke__\">app</span>(model).<span class=\"hljs-title function_ invoke__\">update</span>(update).<span class=\"hljs-title function_ invoke__\">run</span>();\n}\n<span class=\"hljs-keyword\">struct</span> <span class=\"hljs-title class_\">Model</span> {}\n<span class=\"hljs-keyword\">fn</span> <span class=\"hljs-title function_\">model</span>(app: &amp;App) <span class=\"hljs-punctuation\">-&gt;</span> Model {\n    app.<span class=\"hljs-title function_ invoke__\">new_window</span>().<span class=\"hljs-title function_ invoke__\">size</span>(<span class=\"hljs-number\">640</span>, <span class=\"hljs-number\">360</span>).<span class=\"hljs-title function_ invoke__\">view</span>(view).<span class=\"hljs-title function_ invoke__\">build</span>().<span class=\"hljs-title function_ invoke__\">unwrap</span>();\n         Model{}\n}\n<span class=\"hljs-keyword\">fn</span> <span class=\"hljs-title function_\">update</span>(app: &amp;App, m: &amp;<span class=\"hljs-keyword\">mut</span> Model, _update: Update) {}\n\n<span class=\"hljs-keyword\">fn</span> <span class=\"hljs-title function_\">view</span>(app: &amp;App, m: &amp;Model, frame: Frame) {\n    <span class=\"hljs-keyword\">let</span> <span class=\"hljs-variable\">draw</span> = app.<span class=\"hljs-title function_ invoke__\">draw</span>();\n    draw.<span class=\"hljs-title function_ invoke__\">background</span>().<span class=\"hljs-title function_ invoke__\">color</span>(BLACK);\n    draw.<span class=\"hljs-title function_ invoke__\">to_frame</span>(app, &amp;frame).<span class=\"hljs-title function_ invoke__\">unwrap</span>();\n}\n</code></pre>\n<p>Nannou is based on <a href=\"https://thomasbandt.com/model-view-update\"> model-view-update architecture</a>, where ,as the name suggests, the initialization of the model, the update and view are seperated. The update is where all the update is done and view is where the stuffs are viewed(Every sixty seconds in africa a minute passes!?). I won&#39;t go into the implementation of the MVU architecture , as I am don&#39;t understand 80-90% of the thing that is going on here. So let&#39;s quickly go into the implementations before I say something stupid.</p>\n<h1 id=\"what-are-we-doing\">What are we doing?</h1>\n<p> This is something really simple. We will ,kinda, show that the random numbers generated by computers are pseudo random. If we could continue this time for infinite amount of time the of numbers of time a number is choosen at random will be similar, but since the time period required for that to happen is large, it gives us the pseudo numbers give the sense of randomness. </p>\n<p> We will create a struct named <code>Bar</code>  to keep track of an individual bar i.e, the number of times a number is choosen at random. This struct will contain a <code>f32</code> value which will correspond to the height of the bar.</p>\n<pre><code class=\"hljs language-rust\"><span class=\"hljs-keyword\">struct</span> <span class=\"hljs-title class_\">Bar</span> {\n   height: <span class=\"hljs-type\">f32</span>,\n}\n</code></pre>\n<p> Lets implement a constructor for it. I like to call it a constructor but it is actually a static function that generates the initial value.</p>\n<pre><code class=\"hljs language-rust\"><span class=\"hljs-keyword\">impl</span> <span class=\"hljs-title class_\">Bar</span> {\n   <span class=\"hljs-keyword\">fn</span> <span class=\"hljs-title function_\">new</span>() <span class=\"hljs-punctuation\">-&gt;</span> <span class=\"hljs-keyword\">Self</span> {\n        Bar{ height: <span class=\"hljs-number\">0.0</span> }  \n   }\n}\n</code></pre>\n<p> Lets now create the Model struct that will contain most of the things. The model will contain a Vector of Bar; array would have been better options but I always have a hard time working with arrays. </p>\n<pre><code class=\"hljs language-rust\"><span class=\"hljs-keyword\">struct</span> <span class=\"hljs-title class_\">Model</span> {\n   bars: <span class=\"hljs-type\">Vec</span>&lt;Bar&gt;,\n}\n\n<span class=\"hljs-keyword\">impl</span> <span class=\"hljs-title class_\">Model</span> {\n   <span class=\"hljs-keyword\">fn</span> <span class=\"hljs-title function_\">new</span>() <span class=\"hljs-punctuation\">-&gt;</span> <span class=\"hljs-keyword\">Self</span> {\n       Model {\n           bars: <span class=\"hljs-built_in\">vec!</span>[Bar::<span class=\"hljs-title function_ invoke__\">new</span>(); <span class=\"hljs-number\">10</span>],\n       }\n   }\n\n   <span class=\"hljs-keyword\">fn</span> <span class=\"hljs-title function_\">update</span>(&amp;<span class=\"hljs-keyword\">mut</span> <span class=\"hljs-keyword\">self</span>) {\n       <span class=\"hljs-keyword\">self</span>.bars[<span class=\"hljs-title function_ invoke__\">random_range</span>(<span class=\"hljs-number\">0</span>, <span class=\"hljs-number\">10</span>)].height += <span class=\"hljs-number\">1.0</span>;\n   }\n}\n</code></pre>\n<p>We created a vector of bar and in the <code>Model::new()</code> we used created a vector with 10 bars, each one corresponding to each numbers. This code will ,however, not compile, we will have to implement the <code>Clone</code> trait on the Bar to use the quick vector creator <code>vec!</code>.</p>\n<pre><code class=\"hljs language-rust\"><span class=\"hljs-meta\">#[derive(Clone)]</span>\n<span class=\"hljs-keyword\">struct</span> <span class=\"hljs-title class_\">Bar</span>{  \n    height: <span class=\"hljs-type\">f32</span>,\n}\n</code></pre>\n<p>In the update function inside the <code>Model</code>  struct the update function takes a random number, here we are using <code>random_range</code> which gives a random number based on the input. We ,then, take the <code>height</code>  field of the<code>bar</code> at that random index given to us by <code>random_range(0, 10)</code> and increase it by 1. We could have done the same thing in the larger update function but this simulation is pretty simple and this way it looks cleaner.  </p>\n<h1 id=\"finish-it\">Finish It!</h1>\n<p>The model function from our original template doesn&#39;t change a lot. We return a <code>Model</code> struct from the function.</p>\n<pre><code class=\"hljs language-rust\"><span class=\"hljs-keyword\">fn</span> <span class=\"hljs-title function_\">model</span>(app: &amp;App) <span class=\"hljs-punctuation\">-&gt;</span> Model {\n    app.<span class=\"hljs-title function_ invoke__\">new_window</span>().<span class=\"hljs-title function_ invoke__\">size</span>(<span class=\"hljs-number\">640</span>, <span class=\"hljs-number\">360</span>).<span class=\"hljs-title function_ invoke__\">view</span>(view).<span class=\"hljs-title function_ invoke__\">build</span>().<span class=\"hljs-title function_ invoke__\">unwrap</span>();\n    Model::<span class=\"hljs-title function_ invoke__\">new</span>()\n}\n</code></pre>\n<p>The update function too hasn&#39;t changed a lot and looks pretty much the same, except for calling the update function on the <code>Model</code> struct.</p>\n<pre><code class=\"hljs language-rust\"><span class=\"hljs-keyword\">fn</span> <span class=\"hljs-title function_\">update</span>(_app: &amp;App, model: &amp;<span class=\"hljs-keyword\">mut</span> Model, _update: Update) {\n    model.<span class=\"hljs-title function_ invoke__\">update</span>();\n}\n</code></pre>\n<p>This way it looks cleaner than updating it here in this function.</p>\n<p>Now the best part, we could have made something similar to the update function in our <code>Model</code> struct but I wanted to give an example of what doing the processes in the larger function seems like p.s. I wanted to know the size of the window. </p>\n<pre><code class=\"hljs language-rust\"><span class=\"hljs-keyword\">fn</span> <span class=\"hljs-title function_\">view</span>(app: &amp;App, model: &amp;Model, frame: Frame) {\n    <span class=\"hljs-keyword\">let</span> <span class=\"hljs-variable\">draw</span> = app.<span class=\"hljs-title function_ invoke__\">draw</span>();\n    draw.<span class=\"hljs-title function_ invoke__\">background</span>().<span class=\"hljs-title function_ invoke__\">color</span>(BLACK);\n    <span class=\"hljs-keyword\">let</span> <span class=\"hljs-keyword\">mut </span><span class=\"hljs-variable\">i</span>: <span class=\"hljs-type\">f32</span> = <span class=\"hljs-number\">0.0</span>;\n    <span class=\"hljs-keyword\">for</span> <span class=\"hljs-variable\">bar</span> <span class=\"hljs-keyword\">in</span> &amp;model.bars {\n        draw.<span class=\"hljs-title function_ invoke__\">rect</span>()\n            .<span class=\"hljs-title function_ invoke__\">x_y</span>(-<span class=\"hljs-number\">320.0</span> + <span class=\"hljs-number\">70.0</span> * i, <span class=\"hljs-number\">0.0</span>)\n            .<span class=\"hljs-title function_ invoke__\">w_h</span>(<span class=\"hljs-number\">50.0</span>, bar.height);\n        i += <span class=\"hljs-number\">1.0</span>;\n    }\n    draw.<span class=\"hljs-title function_ invoke__\">to_frame</span>(app, &amp;frame).<span class=\"hljs-title function_ invoke__\">unwrap</span>();\n}\n</code></pre>\n<p>Here, we first create a draw object with <code>app.draw()</code>. We color the background black and create a mutable variable named <code>i</code>.  The variable is to provide a gap between each bars. Next we loop through the entire <code>bars</code> vector in the model and for each bar we plot a rectangle at <code>-320 + 70 * i</code> spot. The <code>-320</code> is the left most x-axis on my screen and adding <code>70 * i</code> makes sure that the bars don&#39;t get drawn on top of one another and there is a gap between all the bars. The <code>width</code> of the bar is constant and the <code>height</code> is the bar&#39;s height ,i.e, the number of time a number has been selected &quot;randomly&quot;. As we iterate further we will see that the bars begin to reach an equal level. This is kinda cool that we have a visual representation of the pseudo randomness of the random generated by computers. Also we could have drawn the points on screen as such.</p>\n<pre><code class=\"hljs language-rust\">\\\\ In the implementation of Model\n<span class=\"hljs-keyword\">impl</span> <span class=\"hljs-title class_\">Model</span> {\n\n\\\\ -- Previous Code --\n\n<span class=\"hljs-keyword\">fn</span> <span class=\"hljs-title function_\">display</span>(&amp;<span class=\"hljs-keyword\">self</span>, &amp;draw) {\n    <span class=\"hljs-keyword\">let</span> <span class=\"hljs-keyword\">mut </span><span class=\"hljs-variable\">i</span>: <span class=\"hljs-type\">f32</span> = <span class=\"hljs-number\">0.0</span>;\n    <span class=\"hljs-keyword\">for</span> <span class=\"hljs-variable\">bar</span> <span class=\"hljs-keyword\">in</span> &amp;model.bars {\n        draw.<span class=\"hljs-title function_ invoke__\">rect</span>()\n            .<span class=\"hljs-title function_ invoke__\">x_y</span>(-<span class=\"hljs-number\">320.0</span> + <span class=\"hljs-number\">70.0</span> * i, <span class=\"hljs-number\">0.0</span>)\n            .<span class=\"hljs-title function_ invoke__\">w_h</span>(<span class=\"hljs-number\">50.0</span>, bar.height);\n        i += <span class=\"hljs-number\">1.0</span>;\n    }\n}\n}\n\n\\\\ In the view function\n<span class=\"hljs-keyword\">fn</span> <span class=\"hljs-title function_\">view</span>(app: &amp;App, model: &amp;Model, frame: Frame) {\n    <span class=\"hljs-keyword\">let</span> <span class=\"hljs-variable\">draw</span> = app.<span class=\"hljs-title function_ invoke__\">draw</span>();\n    draw.<span class=\"hljs-title function_ invoke__\">background</span>().<span class=\"hljs-title function_ invoke__\">color</span>(BLACK);\n    model.<span class=\"hljs-title function_ invoke__\">display</span>(&amp;draw);\n    draw.<span class=\"hljs-title function_ invoke__\">to_frame</span>(app, &amp;frame).<span class=\"hljs-title function_ invoke__\">unwrap</span>();\n}\n</code></pre>\n<p>This would have worked as well and this looks way cleaner than the previous version. The entire code can be found here.</p>\n<pre><code class=\"hljs language-rust\"><span class=\"hljs-keyword\">use</span> nannou::prelude::*;\n\n<span class=\"hljs-keyword\">fn</span> <span class=\"hljs-title function_\">main</span>() {\n    nannou::<span class=\"hljs-title function_ invoke__\">app</span>(model).<span class=\"hljs-title function_ invoke__\">update</span>(update).<span class=\"hljs-title function_ invoke__\">run</span>();\n}\n\n<span class=\"hljs-meta\">#[derive(Clone)]</span>\n<span class=\"hljs-keyword\">struct</span> <span class=\"hljs-title class_\">Bar</span> {\n    height: <span class=\"hljs-type\">f32</span>,\n}\n\n<span class=\"hljs-keyword\">impl</span> <span class=\"hljs-title class_\">Bar</span> {\n    <span class=\"hljs-keyword\">fn</span> <span class=\"hljs-title function_\">new</span>() <span class=\"hljs-punctuation\">-&gt;</span> <span class=\"hljs-keyword\">Self</span> {\n        Bar { height: <span class=\"hljs-number\">0.0</span> }\n    }\n}\n\n<span class=\"hljs-keyword\">struct</span> <span class=\"hljs-title class_\">Model</span> {\n    bars: <span class=\"hljs-type\">Vec</span>&lt;Bar&gt;,\n}\n\n<span class=\"hljs-keyword\">impl</span> <span class=\"hljs-title class_\">Model</span> {\n    <span class=\"hljs-keyword\">fn</span> <span class=\"hljs-title function_\">new</span>() <span class=\"hljs-punctuation\">-&gt;</span> <span class=\"hljs-keyword\">Self</span> {\n        Model {\n            bars: <span class=\"hljs-built_in\">vec!</span>[Bar::<span class=\"hljs-title function_ invoke__\">new</span>(); <span class=\"hljs-number\">10</span>],\n        }\n    }\n\n    <span class=\"hljs-keyword\">fn</span> <span class=\"hljs-title function_\">update</span>(&amp;<span class=\"hljs-keyword\">mut</span> <span class=\"hljs-keyword\">self</span>) {\n        <span class=\"hljs-keyword\">self</span>.bars[<span class=\"hljs-title function_ invoke__\">random_range</span>(<span class=\"hljs-number\">0</span>, <span class=\"hljs-number\">10</span>)].height += <span class=\"hljs-number\">1.0</span>;\n    }\n}\n\n<span class=\"hljs-keyword\">fn</span> <span class=\"hljs-title function_\">model</span>(app: &amp;App) <span class=\"hljs-punctuation\">-&gt;</span> Model {\n    app.<span class=\"hljs-title function_ invoke__\">new_window</span>().<span class=\"hljs-title function_ invoke__\">size</span>(<span class=\"hljs-number\">640</span>, <span class=\"hljs-number\">360</span>).<span class=\"hljs-title function_ invoke__\">view</span>(view).<span class=\"hljs-title function_ invoke__\">build</span>().<span class=\"hljs-title function_ invoke__\">unwrap</span>();\n    Model::<span class=\"hljs-title function_ invoke__\">new</span>()\n}\n\n<span class=\"hljs-keyword\">fn</span> <span class=\"hljs-title function_\">update</span>(_app: &amp;App, model: &amp;<span class=\"hljs-keyword\">mut</span> Model, _update: Update) {\n    model.<span class=\"hljs-title function_ invoke__\">update</span>();\n}\n\n<span class=\"hljs-keyword\">fn</span> <span class=\"hljs-title function_\">view</span>(app: &amp;App, model: &amp;Model, frame: Frame) {\n    <span class=\"hljs-keyword\">let</span> <span class=\"hljs-variable\">draw</span> = app.<span class=\"hljs-title function_ invoke__\">draw</span>();\n    draw.<span class=\"hljs-title function_ invoke__\">background</span>().<span class=\"hljs-title function_ invoke__\">color</span>(BLACK);\n    <span class=\"hljs-keyword\">let</span> <span class=\"hljs-keyword\">mut </span><span class=\"hljs-variable\">i</span>: <span class=\"hljs-type\">f32</span> = <span class=\"hljs-number\">0.0</span>;\n    <span class=\"hljs-keyword\">for</span> <span class=\"hljs-variable\">bar</span> <span class=\"hljs-keyword\">in</span> &amp;model.bars {\n        draw.<span class=\"hljs-title function_ invoke__\">rect</span>()\n            .<span class=\"hljs-title function_ invoke__\">x_y</span>(-<span class=\"hljs-number\">320.0</span> + <span class=\"hljs-number\">70.0</span> * i, <span class=\"hljs-number\">0.0</span>)\n            .<span class=\"hljs-title function_ invoke__\">w_h</span>(<span class=\"hljs-number\">50.0</span>, bar.height);\n        i += <span class=\"hljs-number\">1.0</span>;\n    }\n    draw.<span class=\"hljs-title function_ invoke__\">to_frame</span>(app, &amp;frame).<span class=\"hljs-title function_ invoke__\">unwrap</span>();\n}\n</code></pre>\n","bodyBegin":6,"frontmatter":"title: To be or not to be (Random)?!\ndate: 2021-06-21"},"prev":{"link":"2021-06-10-lifetimes_in_rust","blog":{"date":"2021-06-10","title":"Lifetimes In Rust"}},"next":{"link":"2021-07-05-linear_reg","blog":{"date":"2021-07-05","title":"Linear Reg"}}}}